{"version":3,"sources":["client/app/question.component.ts"],"names":[],"mappings":"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","file":"question.component.js","sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { DragulaService } from 'ng2-dragula/ng2-dragula';\n\nimport { StoryService } from './story.service';\nimport { UtilitiesService } from './utilities.service';\nimport { LogService } from './log.service';\n\nimport { Card } from './models/card';\nimport { Story } from './models/story';\n\n@Component({\n    selector: 'question',\n    templateUrl: 'app/question.component.html',\n    styleUrls: [\n        'app/question.component.css',\n        'dragula.min.css'\n    ],\n    viewProviders: [DragulaService]\n})\nexport class QuestionComponent implements OnInit {\n    mode = 'Observable';\n    stories : Story[];\n    story : Story;\n    firstCard : Card;\n    a1 = [];\n    a2 = [];\n    a3 = [];\n    error : boolean = false;\n    finished : boolean = false;\n    activeStoryIndex : number = 0;\n    activeHover : string = null;\n    activeRemoveHover : string = null;\n    activeCard : Card = null;\n    httpError: any;\n\n    constructor(private storyService: StoryService, \n                private logService: LogService,\n                private utilitiesService: UtilitiesService,\n                private dragulaService: DragulaService) {\n\n        // dragulaService.setOptions('first-bag', {\n        //     accepts: (el, target, source, sibling) => {\n        //         let accepted = this.canMove(el, target, source, sibling);\n        //         console.log('accepted ' + accepted);\n        //         console.log('target ' + target);\n                \n        //         return accepted;\n        //     }\n        // });\n    }\n\n    ngOnInit() : void {\n        this.getStories();\n    }\n\n    getStories() : void {\n        this.storyService.getStories()\n            .subscribe(stories => {\n                this.stories = stories;\n                this.nextStory();\n            });\n    }\n\n    private nextStory() {\n        if (typeof this.stories[this.activeStoryIndex] !== \"undefined\") {\n            // get the first story\n            this.story = this.stories[this.activeStoryIndex];\n            // save the first card\n            this.firstCard = this.story.cards[0];\n            // remove the first card from the array`\n            this.story.cards.shift();\n            // randomly sort the rest of the cards\n            this.story.cards = this.utilitiesService.shuffle(this.story.cards);\n            this.utilitiesService.startTimer();\n        } else {\n            // display well done message\n            this.finished = true;\n        }\n    }\n\n    private submit() {\n        if (this.a1.length === 0 || this.a2.length === 0 || this.a3.length === 0) {\n            // change div colour in a transition\n            this.error = true;\n        } else {\n            // create an answer array\n            const answer = [ this.a1[0], this.a2[0], this.a3[0] ];\n            if (answer.length === 3) {\n                answer.unshift(this.firstCard);\n                this.logService.mark(this.story, answer).subscribe(data => {\n                    console.log(data);\n                })\n                this.a1 = [];\n                this.a2 = [];\n                this.a3 = [];\n                this.activeStoryIndex++;\n                this.nextStory();\n            }\n        }\n        // change error flag back once animation is complete\n        setTimeout(() => {\n            this.error = false\n        }, 1000);\n    }\n\n    // Dragular functions\n    private canMove(el, target, source, sibling) {\n        console.log('checking can move:' + target.id);\n        \n        switch (target.id) {\n            case \"a1\":\n                console.log(this.a1.length);\n                return this.a1.length === 0;\n            case \"a2\":\n                return this.a2.length === 0;\n            case \"a3\":\n                return this.a3.length === 0;\n            default:\n                return true;\n        }\n    }\n\n    // Click and click functionality\n    private setActiveCard(card) {\n        this.activeCard = card;\n    }\n\n    private clickToAddOrRemove(pos) {\n        console.log('clicked to add or remove');\n        \n        if (this.activeCard) {\n            switch(pos) {\n                case \"a1\":\n                    if (this.a1.length === 0) {\n                        this.a1 = [];\n                        this.a1.push(this.activeCard);\n                        this.removeCardFromOptions(this.activeCard);\n                    }               \n                    break;\n                case \"a2\":\n                    if (this.a2.length === 0) {\n                        this.a2 = [];\n                        this.a2.push(this.activeCard);\n                        this.removeCardFromOptions(this.activeCard);\n                    }       \n                    break;\n                case \"a3\":\n                    if (this.a3.length === 0) {\n                        this.a3 = [];\n                        this.a3.push(this.activeCard);\n                        this.removeCardFromOptions(this.activeCard);\n                    }       \n                    break;\n            }\n\n            this.setActiveCard(null);\n        } else {\n            this.removeCard(pos);\n        }\n    }\n\n    private removeCard(pos) {\n        switch(pos) {\n            case \"a1\":\n                if (this.a1.length > 0) {\n                    this.story.cards.push(this.a1[0]);\n                    this.a1 = [];\n                }\n                break;\n            case \"a2\":\n                if (this.a2.length > 0) {\n                    this.story.cards.push(this.a2[0]);\n                    this.a2 = [];\n                }\n                break;\n            case \"a3\":\n                if (this.a3.length > 0) {\n                    this.story.cards.push(this.a3[0]);\n                    this.a3 = [];\n                }\n                break;\n        }\n    }\n\n    private removeCardFromOptions(card) {\n        var index : number = this.story.cards.indexOf(card, 0);\n        if (index > -1) {\n            this.story.cards.splice(index, 1);\n        }\n    }\n\n    private hover(pos) {\n        console.log('hovering...');\n        // handle if activeCard is selected\n        if (this.activeCard) {\n            // highlight cell\n            switch(pos) {\n                case \"a1\":\n                    this.activeHover = 'a1';\n                    break;\n                case \"a2\":\n                    this.activeHover = 'a2';\n                    break;\n                case \"a3\":\n                    this.activeHover = 'a3';\n                    break;\n            }\n        } else {\n            switch(pos) {\n                case \"a1\":\n                    this.activeRemoveHover = 'a1';\n                    break;\n                case \"a2\":\n                    this.activeRemoveHover = 'a2';\n                    break;\n                case \"a3\":\n                    this.activeRemoveHover = 'a3';\n                    break;\n            }\n        }\n    }\n\n    private unhover() {\n        this.activeHover = null;\n        this.activeRemoveHover = null;\n    }\n}"]}